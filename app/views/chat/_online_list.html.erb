<% usernames ||= Rails.cache.read("users_chatting") || [] %>
<% usernames.uniq.compact.each do |username| %>
  <% is_guest = username == "Guest" %>
  <% username = "Guest (#{usernames.count('Guest')})" if is_guest %>
  <% avatar_icon = User.by_username(username)&.avatar(size: 20) || image_path("status_offline.png") %>
  <div class="message-container">
    <%= avatar(avatar_icon, size: 20) %>
    <div class="body">
      <div class="username"><%= username %></div>
    </div>
  </div>
<% end %>
